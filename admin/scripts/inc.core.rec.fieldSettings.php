<?php
//////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////
// rec fields table site_settings
//////////////////////////////////////////////////////////////////////
session_start();
// only if logged
if(!isset($_SESSION['logOk'])) {
	return;
}
require_once("inc.core.connectDB.php");
?>
<?php
//////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////
// recup post info
//////////////////////////////////////////////////////////////////////
$field = $_POST['field'];
$value = $_POST['value'];

//////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////
// remove special characters of value
//////////////////////////////////////////////////////////////////////
require_once("inc.core.antiHack.php");

//////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////
// remove bad words of value
//////////////////////////////////////////////////////////////////////
require_once("inc.core.tools.bannedWords.php");

//////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////
// algorithm encode value
//////////////////////////////////////////////////////////////////////
require_once("inc.core.tools.algorithm.encode.php");

// if field = volume 
if($field=="volume") {
	// max 100
	if($value>=100){ $value=100;}
}
// if field = accept coockies 
if($field=="ifActiveAcceptCookies") {
	// kill coockie if = no??????? , '', time()- 3600, "/", $_SERVER['HTTP_HOST'], true, true
	if($value!="yes") {
		setcookie('acceptCookies', '', time() - 3600, '/');
	}
}
// save the new value in the correct field
$connectDBIntelApp->exec("update site_settings set ".$field."='$value' where idSetting='77' limit 1");
echo('&nbsp;<i class="far fa-check-circle green"></i>');
// if check age
if(($field=="ifLimitAge") && ($value=="no")) {
	unset($_SESSION['okAge']);
}
?>